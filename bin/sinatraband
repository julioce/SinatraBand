#!/usr/bin/env ruby

require 'pathname'
require 'erb'
require_relative '../lib/helper.rb'

def create_app
  #Creates de App diretory
  mkdir "./#{@APP_NAME}"

  #Creates de App file
  generate_file_from_template "", :app, :rb

  #Creates de Database file
  generate_file_from_template "", :database, :rb

  #Creates de View diretory
  mkdir "./#{@APP_NAME}/views"

  #Creates de index file
  generate_file_from_template "/views", :index, :erb
end


def create_model
  puts "Creating model"
end


def proccess_argument
  
  if ARGV.empty?
    put_error_and_quit "Error: Missing arguments"
  else
    #Get the global current path
    @ROOT = Pathname(__FILE__).dirname.realpath.to_s()+"/../lib/templates"

    #Defines operation
    case ARGV[0]
      when "create"
        #Get de App name
        if ARGV[1].nil?
          put_error_and_quit "Error: Missing arguments for create action"
        else
          @APP_NAME = ARGV[1]
          create_app
        end
      when "model"
        create_model
      else
        put_error_and_quit "Error: Missing or unknow arguments"
    end
    
  end

end

#start de proccess
proccess_argument
